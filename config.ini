[device]
adapter = hci0
mac_addr = 6C:B2:FD:86:82:4D
alias = BT-TH-FD86824D
type = RNG_BATT
device_id = 48,49,50,51

[data]
enable_polling = true
poll_interval = 180  # Increased from 120 - less aggressive
poll_after_proxy_cycle = true
poll_cycle_dwell_seconds = 40.0
poll_cycle_timeout_seconds = 60.0
temperature_unit = F
fields =

[remote_logging]
enabled = false
url = https://example.com/post.php
auth_header = auth_header

[mqtt]
enabled = true
server = 192.168.1.89
port = 1883
topic = solar/state
user = pi
password = 12341
homeassistant_discovery = true

[pvoutput]
enabled = false
api_key =
system_id =

[home_assistant_proxy]
enabled = true
use_native_api = true
with_renogy_client = true

# ESPHome native API settings
native_api_port = 6053
device_name = renogy.proxy
mdns_ip =

# ESPHome API sensor integration
esphome_sensors = true

# CHANGED: Use scheduled mode instead of continuous
# This allows proxy scanning to continue while Renogy is being read
renogy_poll_mode = scheduled
# Read Renogy every 60 seconds (was 30)
renogy_read_interval = 30

# BLE scanning settings - OPTIMIZED
adapter = hci0
# Don't pause during renogy - let both run
pause_during_renogy = false
# Reduce airtime restrictions
airtime_settle_seconds = 0.1
airtime_window_seconds = 60  # Increased from 30
# CRITICAL FIX: Less aggressive health monitoring
health_check_interval = 60  # Increased from 30
health_check_threshold = 120  # Increased from 45 - more lenient
health_reset_adapter = true
health_reset_limit = 3
